general {
    # Start hyprlock if not already running
    lock_cmd = pidof hyprlock || hyprlock

    # Turn displays off and lock before suspend
    before_sleep_cmd = hyprctl dispatch dpms off && hyprlock

    # DPMS state persists across suspend → force displays on
    after_sleep_cmd = hyprctl dispatch dpms on

    # Prevent unlocked resume (wait until lock is active)
    inhibit_sleep = 3
}

# Lid closed → suspend
listener {
    event = sw-down
    on-status-changed = systemctl suspend
}

# Lid opened → turn displays on
listener {
    event = sw-up
    on-status-changed = hyprctl dispatch dpms on
}

# Lock after 7 minutes
listener {
    timeout = 420
    on-timeout = pidof hyprlock || hyprlock
}

# After 7 minutes: turn displays off only if locked
listener {
    timeout = 420
    on-timeout = pidof hyprlock && hyprctl dispatch dpms off
}

# Suspend after 10 minutes
listener {
    timeout = 600
    on-timeout = systemctl suspend
}
