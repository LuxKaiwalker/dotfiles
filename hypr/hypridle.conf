# =========================
# General hooks for suspend / resume
# =========================
general {
    # Lock command (disabled)
    # lock_cmd = pidof hyprlock || hyprlock

    # Aesthetic suspend flow:
    # 1. Turn displays off
    # 2. Lock session (disabled)
    before_sleep_cmd = hyprctl dispatch dpms off
    # before_sleep_cmd = hyprctl dispatch dpms off && hyprlock

    # CRITICAL:
    # DPMS state survives suspend, so displays MUST be
    # explicitly powered back on after resume
    after_sleep_cmd = hyprctl dispatch dpms on

    # Ensure the lock is fully active before sleeping
    # Prevents race conditions and unlocked resumes
    inhibit_sleep = 3
}

# =========================
# Lid switch handling
# =========================

# Lid closed → suspend system
listener {
    event = sw-down
    on-status-changed = systemctl suspend
}

# Lid opened → force displays back on
listener {
    event = sw-up
    on-status-changed = hyprctl dispatch dpms on
}

# =========================
# Idle timeouts
# =========================

# Lock after inactivity (disabled)
listener {
    timeout = 420        # 7 minutes

    # on-timeout = pidof hyprlock || hyprlock
}

# Turn displays off after inactivity (DPMS)
listener {
    timeout = 420        # 7 minutes

    # Only power off displays if already locked (disabled condition)
    # on-timeout = pidof hyprlock && hyprctl dispatch dpms off
    on-timeout = hyprctl dispatch dpms off
}

# Suspend after inactivity
listener {
    timeout = 600        # 10 minutes

    # DPMS off + lock were guaranteed by before_sleep_cmd
    on-timeout = systemctl suspend
}
